# Настройка Telegram Mini App (TMA)

## Что было создано

1. **Страница Mini App**: `app/tma/page.tsx` и `app/tma/TmaClient.tsx`
2. **Интеграция с ботом**: Команда `/start` теперь включает кнопку для открытия Mini App
3. **Telegram Web App SDK**: Автоматически подключен в layout

## Настройка в BotFather

1. Откройте [@BotFather](https://t.me/BotFather) в Telegram
2. Выберите вашего бота: `/mybots`
3. Выберите "Bot Settings" → "Menu Button"
4. Настройте кнопку меню:
   - **Text**: "Открыть FindOrigin" (или любой другой текст)
   - **URL**: `https://ваш-домен.vercel.app/tma`

Или используйте команду:
```
/setmenubutton
```

Затем укажите:
- **Bot**: ваш бот
- **Button text**: "Открыть FindOrigin"
- **URL**: `https://ваш-домен.vercel.app/tma`

## Переменные окружения

Убедитесь, что в `.env.local` или настройках Vercel установлено:

```env
NEXT_PUBLIC_APP_URL=https://ваш-домен.vercel.app
```

Это нужно для правильной генерации URL Mini App в команде `/start`.

## Функциональность

### Mini App включает:

- ✅ Адаптивный UI, который использует тему Telegram
- ✅ Интеграция с Telegram Web App API
- ✅ Кнопка "Назад" для возврата к форме
- ✅ Главная кнопка Telegram для запуска анализа
- ✅ Отображение результатов анализа с источниками
- ✅ Автоматическое определение темы (светлая/тёмная)

### API Endpoint

Mini App использует существующий endpoint `/api/test-search` для анализа текста.

## Тестирование

1. Разверните приложение на Vercel
2. Настройте Menu Button в BotFather
3. Откройте бота в Telegram
4. Нажмите на кнопку меню или используйте команду `/start` и нажмите на кнопку "Открыть Mini App"
5. Введите текст для анализа
6. Нажмите на главную кнопку Telegram внизу экрана

## Особенности

- Mini App автоматически расширяется на весь экран
- Использует цвета темы Telegram пользователя
- Поддерживает светлую и тёмную темы
- Главная кнопка Telegram показывает прогресс во время анализа
- Кнопка "Назад" появляется после получения результатов
